 puml 
@startuml
skinparam classAttributeIconSize 0
skinparam linetype ortho

package CS {
    class int{}
    class string{}
    class bool{}
}

package MonoGame {
    class KeyboardState{}
    class GameTime{}
    class GraphicsDevice{}
    class SpriteBatch{}
    class Game{}
}

package CatRoyale{
    
    class CatRoyal{
        +JeuChat : Jeu
        -menuMain : MainMenu
        -menuInGame : InGame
        -menuEnd : MenuEnd
        {static} +savePath : string
        {static} +defaultSaveFileName : string
        {static} +autoSaveFileName : string
        +CatRoyal()
        #Initialize() : void
        #LoadContent() : void
        #Update(GameTime gameTime) : void
        #Draw(GameTime gameTime) : void
        {static} +SetMenu(EtatMenu menu) : void
        {static} +Quitter() : void
        {static} +SaveGame(string FileName) : void
        {static} +LoadGame(string FileName) : void
    }
    class MainMenu{
        +LoadContent(ContentManager content) : void
        +Update() : void
        +Draw(GraphicsDevice graphics, SpriteBatch spriteBatch) : void
    }
    
    class InGame{
        +LoadContent(ContentManager content, GraphicsDevice graphics) : void
        +Update() : void
        +Draw(GraphicsDevice graphics, SpriteBatch spriteBatch) : void
    }
    
    class MenuEnd{
        +LoadContent(ContentManager content) : void
        +Update() : void
        +Draw(GraphicsDevice graphics, SpriteBatch spriteBatch) : void
    }
   
   class EtatMenu <<enum>> {
        MENUMAIN
        INGAME
        ENDGAME
   }
   
   class ClicPhase <<enum>> {
        INITIAL
        ANNULER
        CONFIRMER_CARTE
        CLIC_SUR_CASE_INVOCATION
        CONFIRMER_CASE
   }
    
    class Jeu{
        +Plateau : Plateau
        +Joueur1 : Joueur
        +Joueur2 : Joueur
        +CartesExistantes : ListeDeCartes
        +JouerActuel : Joueur
        +Phase : EtatAutomate
        +CarteI, CaseI, CaseJ, LastCaseI, LasteCaseJ : int
        +Jeu(int longueur, int largeur, string nom1, string nom2)
        +Jeu()
        +victory() : bool
        +InitTurn() : void
        +EndTurn() : void
        +transition(KeyboardState current, KeyboardState last, ClicOhase phaseSouris) : void
        +PeutSelectionnerCarte(int i) : bool
        +PeutSelectionnerInvocation(int lig, int col) : bool
        +PeutInvoquer(int i, int lig, int col) : bool
        +PeutAttaquer(int lig1, int col1, int lig2, int col2) : bool
        +PeutDeplacer(int lig1, int col1, int lig2, int col2) : bool
        +PeutAttaquerOuDeplacer(int lig1, int col1, int lig2, int col2) : bool
   }
    note top of Jeu
        JouerActuel toujours égal soit à Joueur1 soit à Joueur2
    end note
   
   class EtatAutomate <<enum>> {
        SELECTION_CARTE
        SELECTION_CASE_CARTE
        SELECTION_CASE_SOURCE
        SELECTION_CASE_CIBLE
   }
    
    class Plateau {
        +TowerJ1 : Invocation
        +TowerJ2 : Invocation
        +Map :  ListeDeCases[]
        +Plateau(int longueur, int largeur)
        +Plateau()
        +Longueur() : int
        +Largeur() : int
        +setEntityAt(Invocation invoc, int ligne, int colonne) : void
        +getEntityAt(int ligne, int colonne) : Invocation?
        +isEmpty(int ligne, int colonne) : bool
        +deleteAt(int ligne, int colonne) : bool
        +invoke(Carte carte, int ligne, int colonne Joueur invocateur) : bool
        +move(int ligneDepart, int colonneDepart, int ligneArrive, int colonneArrive) : void
        +attack(int ligneDepart, int colonneDepart, int ligneArrive, int colonneArrive) : void
        +victory(Joueur joueur) : bool
        +isTower(Invocation invoc) : bool
    }
    note right of Plateau::TowerJ1
        TowerJ1 est juste une référence vers la tour du joueur1
        pour avoir un accès direct sans la chercher
    end note
    note right of Plateau::TowerJ2
        TowerJ2 est juste une référence vers la tour du joueur2
        pour avoir un accès direct sans la chercher
    end note
    
    class ListeDeCases{
        +Cases : CasePlateau
        +LigneDeCases()
    }
    
    class CasePlateau{
        +EstVide : bool
        +Invoc : Invocation?
        +CasePlateau(bool estVide, Invocation? invocation)
        +CasePlateau()
    }
    note right of CasePlateau::Invoc
        Invoc vaut null si EstVide est à true
    end note
    
    class Joueur {
        +Pseudo : string
        +WinStreak : int
        +Jauge : int
        +Main : ListeIdCartes
        +Deck : ListeIdCartes
        +MAX_JAUGE = 15
        +Joueur(string pseudo, int winStreak)
        +Joueur()
        +remplirJauge(int niveau) : void
        +reduireJauge(int usage) : void
        +getNbCartesInMain() : int
        +getNbCartesInDeck() : int
        +addCarteInMain(Carte carte) : void
        +addCarteInMain(string carte) : void
        +addCarteInDeck(Carte carte) : void
        +addCarteInDeck(string carte) : void
        +getCarteInMainAt(int i, ListeDeCartes cartes) : Carte
        +getCarteInDeckAt(int i, ListeDeCartes cartes) : Carte
        +deleteCarteInMain(Carte carte) : void
        +deleteCarteInMainAt(int i) : void
        +deleteCarteInDeck(Carte carte) : void
        +deleteCarteInDeckAt(int i) : void
        +putCarteInDeckFromMainAt(int i) : void
        +pioche() : void
    }
    note right of Joueur::Pseudo
        Le pseudo est considéré comme unique
    end note
    
    class ListeIdCartes {
        +IdCartes : string[]
        +ListeIdCartes()
        +Length() : int
        +getCarteAt(int i, ListeDeCartes cartes) : Carte
        +getIdAt(int i) : string
        +setCarteAt(int i, Carte carte) : void
        +setIdAt(int i, string carte) : void
        +removeCarteAt(int i, ListeDeCartes cartes) : Carte
        +removeIdAt(int i) : string
        +getIndexOf(Carte carte) : int
        +getIndexOf(string carte) : int
        +insertCarteAt(int i, Carte carte) : void
        +insertIdAt(int i, string carte) : void
        +appendCarte(Carte carte) : void
        +appendId(string carte) : void
    }
    note right of ListeIdCartes::IdCartes
        Les string représentent le nom de la carte
        (supposé unique et existante dans Jeu.CartesExistantes)
    end note
    
    class ListeDeCartes {
        +Cartes : Carte[]
        +ListeDeCartes()
        +Length() : int
        +GetCarteByName(string name) : Carte
        +getCarteAt(int i) : Carte
        +setCarteAt(int i, Carte carte) : void
        +removeCarteAt(int i) : Carte
        +getIndexOf(Carte carte) : int
        +insertCarteAt(int i, Carte carte) : void
        +appendCarte(Carte carte) : void
    }
    
    class Carte {
        +Vie : int
        +Degat : int
        +Nom : string
        +Image : string 
        +SpriteInvocation : string
        +Cout : int
        +Type : TypeDeCarte
        +Rarete : TypeRarete
        '+Carte(int vie, int degat, int cout, string nom, string image, TypeDeCarte type, TypeRarete rarete, string spriteInvocation)
        +Carte()
        +generateInvocation() : Invocation
        +toString() : string        
    }
    
    class TypeDeCarte <<enum>> {
        COMBATTANT
        SORT
        OBJET
    }
    
    class TypeRarete <<enum>> {
        COMMUNE
        RARE
        EPIQUE
        LEGENDAIRE
    }
    
    class Invocation {
        +PseudoInvocateur : string
        +MaxVie : int
        +Vie : int
        +Degat : int
        +Image : string
        +PeutBouger : bool
        +PeutAttaquer : bool
        +Invocation(int vie, int degat, string image)
        +Invocation()
        +getVie() : int
        +takeDamage(int degat) : bool
        +takeVie(int vie) : bool
    }
    note right of Invocation::PseudoInvocateur
        PseudoInvocateur est utilisé pour la serialization
        et contient précisément le pseudo de Invocateur
    end note
    
    Game <|-- CatRoyal
    CatRoyal *-- Jeu
    CatRoyal *-- MainMenu
    CatRoyal *-- InGame
    CatRoyal *-- MenuEnd
    Jeu *-- Plateau
    Jeu "1"*--"3" Joueur
    Jeu *-- ListeDeCartes
    Jeu *-- EtatAutomate
    Plateau "1"*--"2" Invocation
    Plateau "1"*--"*" ListeDeCases
    ListeDeCases "1"*--"*" CasePlateau
    CasePlateau "1"*--"0..1" Invocation
    Joueur "1"*--"2" ListeIdCartes
    ListeDeCartes "1"*--"*" Carte
    Carte *-- TypeDeCarte
    Carte *-- TypeRarete
}
note as N1
    <size:22>Dû au trop grand nombre d'attributs et méthodes nécéssaires à ce projet,
    <size:22>nous avons décidé de ne pas représenter les attributs et méthodes private,
    <size:22>sauf si nous les jugeons important.
end note
@enduml